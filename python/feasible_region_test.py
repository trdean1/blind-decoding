import numpy as np
import dynamic
from FeasibleRegion import FeasibleRegion


Y = [[-2.9559865737125,  2.5865278325864, -2.2980562996102,  0.7369790120865,
-1.7022470264114,  2.5865278325864,  2.5865278325864, -0.7369790120865,
-1.9907185593875 ],
[  1.2508223406517, -0.7159569731051,  2.9493672391056, -3.8027781425851,
3.6435053746187, -0.7159569731051, -0.7159569731051,  3.8027781425851,
1.4100951086181 ],
[ -0.9635641883542, -1.4738581147596, -2.9837682836541, -1.3922099258609,
-2.0144903304535, -1.4738581147596, -1.4738581147596,  1.3922099258609,
2.4431360679602 ],
[ -0.8759863225138, -0.8875888657254,  2.6402078223407, -1.6158556098730,
1.2462441219873, -0.8875888657254, -0.8875888657254,  1.6158556098730,
-0.5063748346281 ]]


U_i = [[ -0.0528368520860,  0.0018089247339, -0.0934020602292,  0.0640784675058],
[  0.1123168564818, -0.0154594953961, -0.0433106680742,  0.0299184522178 ],
[  0.0143772089628,  0.1204140139453, -0.0208770819374, -0.0219751804950 ],
[ -0.0033891996287, -0.0297186311760, -0.0677450265753, -0.1007021730710 ]]

U_i = np.matrix(U_i)
Y = np.matrix(Y)

fs = FeasibleRegion( Y )

###################################
# Basic test
###################################
print 'Insert first entry'
fs.insert( 0, 0 )

print 'Make full rank'
fs.insert( 0, 1 )
fs.insert( 0, 2 )
fs.insert( 0, 3 )

print 'Anything else should be redundant'
fs.insert( 0, 5 )

print '-'*60
print 'New method:'
print fs.p[0]

p = dynamic.orthogonalize_p( Y.T )
for i in range(p.shape[0]):
    p[i,:] /= np.linalg.norm(p[i,:])

print 'Old method:'
print p

print 'Difference: %e' % np.linalg.norm(fs.p[0] - p)
